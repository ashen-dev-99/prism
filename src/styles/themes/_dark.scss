// Prism Theme - Dark Theme
// =====================================

[data-theme='dark'] {
  // Override variables for dark theme
  --color-primary: #{$primary-color};
  --color-primary-dark: #{$primary-dark};
  --color-primary-light: #{$primary-light};
  
  --color-secondary: #{$secondary-color};
  --color-secondary-dark: #{$secondary-dark};
  --color-secondary-light: #{$secondary-light};
  
  --color-success: #{$success-color};
  --color-warning: #{$warning-color};
  --color-error: #{$error-color};
  --color-info: #{$info-color};
  
  --color-white: #{$white};
  --color-gray-50: #{$gray-900};
  --color-gray-100: #{$gray-800};
  --color-gray-200: #{$gray-700};
  --color-gray-300: #{$gray-600};
  --color-gray-400: #{$gray-500};
  --color-gray-500: #{$gray-400};
  --color-gray-600: #{$gray-300};
  --color-gray-700: #{$gray-200};
  --color-gray-800: #{$gray-100};
  --color-gray-900: #{$gray-50};
  --color-black: #{$black};
  
  --text-primary: #{$white};
  --text-secondary: #{$gray-300};
  --text-muted: #{$gray-400};
  --text-inverse: #{$gray-900};
  
  --bg-primary: #{$gray-900};
  --bg-secondary: #{$gray-800};
  --bg-muted: #{$gray-700};
  --bg-dark: #{$white};
  
  --border-color: #{$gray-700};
  --border-color-dark: #{$gray-600};
  
  // Dark theme specific styles
  body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
  }
  
        .header {
          background-color: var(--bg-primary);
          border-bottom-color: var(--border-color);
          
          .header-brand {
            color: var(--text-primary);
            
            .header-brand-logo {
              &--light {
                display: none;
              }
              
              &--dark {
                display: block;
              }
            }
          }
          
          .header-search {
            .search-input {
              background-color: var(--bg-secondary);
              border-color: var(--border-color);
              color: var(--text-primary);
              
              &::placeholder {
                color: var(--text-muted);
              }
            }
            
            .search-icon {
              color: var(--text-muted);
            }
          }
  }
  
  .sidebar {
    background-color: var(--bg-primary);
    border-right-color: var(--border-color);
    
    .sidebar-brand {
      color: var(--text-primary);
    }
    
    .sidebar-nav-section-title {
      color: var(--text-muted);
    }
    
    .sidebar-nav-link {
      color: var(--text-secondary);
      
      &:hover {
        color: var(--text-primary);
        background-color: var(--bg-secondary);
      }
      
      &.active {
        color: var(--color-primary);
        background-color: color-alpha(var(--color-primary), 0.1);
      }
    }
  }
  
  .main-content {
    background-color: var(--bg-primary);
    
    .main-content-header-title {
      color: var(--text-primary);
    }
    
    .main-content-header-subtitle {
      color: var(--text-secondary);
    }
  }
  
  .card {
    background-color: var(--bg-primary);
    border-color: var(--border-color);
    
    .card-header {
      background-color: var(--bg-primary);
      border-bottom-color: var(--border-color);
    }
    
    .card-title {
      color: var(--text-primary);
    }
    
    .card-footer {
      background-color: var(--bg-secondary);
      border-top-color: var(--border-color);
    }
  }
  
  .btn--primary {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
    color: var(--color-white);
  }
  
  .btn--secondary {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
    color: var(--text-primary);
    
    &:hover {
      background-color: var(--bg-muted);
      border-color: var(--border-color-dark);
    }
  }
  
  .form-control {
    background-color: var(--bg-primary);
    border-color: var(--border-color);
    color: var(--text-primary);
    
    &::placeholder {
      color: var(--text-muted);
    }
    
    &:focus {
      border-color: var(--color-primary);
      background-color: var(--bg-primary);
    }
  }
  
  .form-label {
    color: var(--text-primary);
  }
  
  .table {
    color: var(--text-primary);
    
    th {
      background-color: var(--bg-secondary);
      color: var(--text-secondary);
      border-bottom-color: var(--border-color);
    }
    
    td {
      border-bottom-color: var(--border-color);
    }
    
    tbody tr:hover {
      background-color: var(--bg-secondary);
    }
  }
  
  .modal-content {
    background-color: var(--bg-primary);
    border-color: var(--border-color);
    
    .modal-header {
      background-color: var(--bg-primary);
      border-bottom-color: var(--border-color);
    }
    
    .modal-title {
      color: var(--text-primary);
    }
    
    .modal-footer {
      background-color: var(--bg-secondary);
      border-top-color: var(--border-color);
    }
  }
  
  .dropdown-menu {
    background-color: var(--bg-primary);
    border-color: var(--border-color);
    
    .dropdown-item {
      color: var(--text-primary);
      
      &:hover {
        background-color: var(--bg-secondary);
      }
      
      &.active {
        background-color: var(--primary-color);
        color: var(--white);
      }
    }
    
    .dropdown-divider {
      border-top-color: var(--border-color);
    }
    
    .dropdown-header {
      color: var(--text-muted);
    }
    
    .dropdown-text {
      color: var(--text-muted);
    }
  }
  
  // Notification Dropdown Dark Mode
  .notification-dropdown {
    background-color: var(--bg-primary) !important;
    border-color: var(--border-color) !important;
    
    .notification-dropdown-header {
      border-bottom-color: var(--border-color);
      
      .notification-title {
        color: var(--text-primary);
      }
      
      .notification-actions {
        .notification-btn {
          &--ghost {
            background-color: transparent;
            color: var(--text-secondary);
            border-color: var(--border-color);
            
            &:hover {
              background-color: var(--bg-secondary);
              color: var(--text-primary);
              border-color: var(--border-color);
            }
          }
          
          &--primary {
            background-color: var(--primary-color);
            color: var(--white);
            border-color: var(--primary-color);
            
            &:hover {
              background-color: color-alpha($primary-color, 0.8);
              border-color: color-alpha($primary-color, 0.8);
            }
          }
        }
      }
    }
    
    .notification-dropdown-footer {
      border-top-color: var(--border-color);
    }
    
    .notification-item {
      border-bottom-color: var(--border-color);
      color: var(--text-primary);
      
      &:hover {
        background-color: var(--bg-secondary);
      }
      
      &.unread {
        background-color: color-alpha($primary-color, 0.1);
      }
      
      .notification-content {
        .notification-icon {
          // Extended notification types dark mode
          &--announcement { background-color: color-alpha($purple-400, 0.1); color: $purple-400; }
          &--promotion { background-color: color-alpha($orange-400, 0.1); color: $orange-400; }
          &--system { background-color: color-alpha($gray-400, 0.1); color: $gray-400; }
          &--security { background-color: color-alpha($red-400, 0.1); color: $red-400; }
          &--reminder { background-color: color-alpha($blue-400, 0.1); color: $blue-400; }
          &--feedback { background-color: color-alpha($green-400, 0.1); color: $green-400; }
        }
        
        .notification-details {
          .notification-title {
            color: var(--text-primary);
          }
          
          .notification-text {
            color: var(--text-secondary);
          }
          
          .notification-time {
            color: var(--text-muted);
          }
          
          .notification-cta {
            .notification-cta-btn {
              &--info {
                background-color: var(--info-color);
                color: var(--white);
                border-color: var(--info-color);
                
                &:hover {
                  background-color: color-alpha($info-color, 0.8);
                  border-color: color-alpha($info-color, 0.8);
                }
              }
              
              &--success {
                background-color: var(--success-color);
                color: var(--white);
                border-color: var(--success-color);
                
                &:hover {
                  background-color: color-alpha($success-color, 0.8);
                  border-color: color-alpha($success-color, 0.8);
                }
              }
              
              &--warning {
                background-color: var(--warning-color);
                color: var(--white);
                border-color: var(--warning-color);
                
                &:hover {
                  background-color: color-alpha($warning-color, 0.8);
                  border-color: color-alpha($warning-color, 0.8);
                }
              }
              
              &--error {
                background-color: var(--error-color);
                color: var(--white);
                border-color: var(--error-color);
                
                &:hover {
                  background-color: color-alpha($error-color, 0.8);
                  border-color: color-alpha($error-color, 0.8);
                }
              }
              
              &--announcement {
                background-color: $purple-400;
                color: var(--white);
                border-color: $purple-400;
                
                &:hover {
                  background-color: color-alpha($purple-400, 0.8);
                  border-color: color-alpha($purple-400, 0.8);
                }
              }
              
              &--promotion {
                background-color: $orange-400;
                color: var(--white);
                border-color: $orange-400;
                
                &:hover {
                  background-color: color-alpha($orange-400, 0.8);
                  border-color: color-alpha($orange-400, 0.8);
                }
              }
              
              &--system {
                background-color: $gray-400;
                color: var(--white);
                border-color: $gray-400;
                
                &:hover {
                  background-color: color-alpha($gray-400, 0.8);
                  border-color: color-alpha($gray-400, 0.8);
                }
              }
              
              &--security {
                background-color: $red-400;
                color: var(--white);
                border-color: $red-400;
                
                &:hover {
                  background-color: color-alpha($red-400, 0.8);
                  border-color: color-alpha($red-400, 0.8);
                }
              }
              
              &--reminder {
                background-color: $blue-400;
                color: var(--white);
                border-color: $blue-400;
                
                &:hover {
                  background-color: color-alpha($blue-400, 0.8);
                  border-color: color-alpha($blue-400, 0.8);
                }
              }
              
              &--feedback {
                background-color: $green-400;
                color: var(--white);
                border-color: $green-400;
                
                &:hover {
                  background-color: color-alpha($green-400, 0.8);
                  border-color: color-alpha($green-400, 0.8);
                }
              }
            }
          }
        }
      }
    }
  }
  
  // Header Search Dark Mode
  .header-search {
    .search-toggle {
      color: var(--text-secondary);
      
      &:hover {
        background-color: var(--bg-secondary);
        color: var(--text-primary);
        border-color: var(--border-color);
      }
    }

    .search-dropdown {
      background-color: var(--bg-primary) !important;
      border-color: var(--border-color) !important;

      .search-dropdown-header {
        background-color: var(--bg-secondary);
        border-bottom-color: var(--border-color);

        .search-title {
          color: var(--text-primary);
        }
      }

      .search-dropdown-body {
        .search-input-container {
          .search-input {
            background-color: var(--bg-secondary);
            border-color: var(--border-color);
            color: var(--text-primary);

            &:focus {
              border-color: var(--primary-color);
              box-shadow: 0 0 0 2px color-alpha($primary-color, 0.1);
            }

            &::placeholder {
              color: var(--text-muted);
            }
          }

          .search-icon {
            color: var(--text-muted);
          }
        }

        .search-results {
          .search-result-item {
            background-color: var(--bg-secondary);
            color: var(--text-primary);

            &:hover {
              background-color: var(--bg-muted);
              border-color: var(--border-color);
            }

            .search-result-icon {
              background-color: color-alpha($primary-color, 0.1);
              color: var(--primary-color);
            }

            .search-result-content {
              .search-result-title {
                color: var(--text-primary);
              }

              .search-result-description {
                color: var(--text-secondary);
              }
            }

            .search-result-meta {
              color: var(--text-muted);

              .search-result-type {
                background-color: color-alpha($primary-color, 0.1);
                color: var(--primary-color);
              }
            }
          }

          .search-no-results {
            color: var(--text-muted);

            .search-no-results-icon {
              color: var(--text-muted);
            }
          }
        }
      }

      .search-dropdown-footer {
        background-color: var(--bg-secondary);
        border-top-color: var(--border-color);

        .search-shortcuts {
          .search-shortcut {
            color: var(--text-muted);

            kbd {
              background-color: var(--bg-muted);
              color: var(--text-primary);
              border-color: var(--border-color);
            }
          }
        }
      }
    }
  }

  // User Toggle Button Dark Mode
  .user-toggle {
    color: var(--text-primary);
    
    .user-name {
      color: var(--text-primary);
    }
    
    .user-arrow {
      color: var(--text-muted);
    }
    
    &:hover {
      background-color: var(--bg-secondary);
      
      .user-name {
        color: var(--text-primary);
      }
      
      .user-arrow {
        color: var(--text-primary);
      }
    }
  }

  // User Dropdown Dark Mode
  .user-dropdown {
    background-color: var(--bg-primary) !important;
    border-color: var(--border-color) !important;
    
    .user-dropdown-header {
      border-bottom-color: var(--border-color);
      
      .user-info {
        .user-name {
          color: var(--text-primary);
        }
        
        .user-email {
          color: var(--text-secondary);
        }
      }
    }
    
    .user-dropdown-body {
      .user-item {
        color: var(--text-primary);
        border-bottom-color: var(--border-color);
        
        &:hover {
          background-color: var(--bg-secondary);
          color: var(--text-primary);
        }
        
        &.active {
          background-color: color-alpha($primary-color, 0.1);
          color: var(--primary-color);
        }
        
        &.divider {
          background-color: var(--border-color);
        }
        
        .user-item-icon {
          color: var(--text-secondary);
        }
        
        &:hover .user-item-icon {
          color: var(--text-primary);
        }
      }
    }
    
    .user-item {
      color: var(--text-primary);
      
      &:hover {
        background-color: var(--bg-secondary);
      }
      
      &.active {
        background-color: color-alpha($primary-color, 0.1);
        color: var(--primary-color);
      }
      
      .user-icon {
        color: var(--text-secondary);
      }
    }
  }
  
  .alert {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
  }
  
  .progress {
    background-color: var(--bg-secondary);
  }
  
  .progress-bar {
    background-color: var(--color-primary);
  }
  
  .nav-link {
    color: var(--text-secondary);
    
    &:hover {
      color: var(--text-primary);
      background-color: var(--bg-secondary);
    }
    
    &.active {
      color: var(--color-primary);
      background-color: color-alpha(var(--color-primary), 0.1);
    }
  }
  
  .tabs-nav {
    border-bottom-color: var(--border-color);
    
    &-link {
      color: var(--text-secondary);
      border-color: var(--border-color);
      
      &:hover {
        background-color: var(--bg-secondary);
        border-color: var(--border-color);
      }
      
      &.active {
        background-color: var(--bg-primary);
        border-color: var(--border-color);
        color: var(--text-primary);
      }
    }
  }
  
  .footer {
    background-color: var(--bg-primary);
    border-top-color: var(--border-color);
    
    .footer-section-title {
      color: var(--text-primary);
    }
    
    .footer-section-text {
      color: var(--text-secondary);
    }
    
    .footer-bottom-text {
      color: var(--text-secondary);
    }
  }
  
  code {
    background-color: var(--bg-secondary);
    color: var(--color-error);
  }
  
  pre {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
  }
  
  blockquote {
    background-color: var(--bg-secondary);
    border-left-color: var(--color-primary);
    color: var(--text-secondary);
  }
  
  // Scrollbar styles for dark theme
  ::-webkit-scrollbar-track {
    background: var(--bg-secondary);
  }
  
  ::-webkit-scrollbar-thumb {
    background: var(--color-gray-300);
    
    &:hover {
      background: var(--color-gray-400);
    }
  }
}

// Dark theme media query fallback
@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    --color-primary: #{$primary-color};
    --color-primary-dark: #{$primary-dark};
    --color-primary-light: #{$primary-light};
    
    --text-primary: #{$white};
    --text-secondary: #{$gray-300};
    --text-muted: #{$gray-400};
    
    --bg-primary: #{$gray-900};
    --bg-secondary: #{$gray-800};
    --bg-muted: #{$gray-700};
    
    --border-color: #{$gray-700};
    --border-color-dark: #{$gray-600};
    
    body {
      background-color: var(--bg-primary);
      color: var(--text-primary);
    }
  }
}
